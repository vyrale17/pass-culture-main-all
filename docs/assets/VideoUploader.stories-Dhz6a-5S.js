import{j as e}from"./jsx-runtime-0r2nTPIS.js";import{P as S,c as I}from"./testUtils-8qmPqGZw.js";import{V as D}from"./index-BPV12_yI.js";import{r as s}from"./iframe-DlYLE1J1.js";import{B as c,b as v,a as g,c as L}from"./Button-D-No98sc.js";import{f as A}from"./full-edit-CxAaM2Fv.js";import{f as q,a as M}from"./full-more-Cfm5WMtk.js";import{s as F}from"./stroke-video-Cd5kQZzx.js";import{a as j}from"./api-CaVgnVjC.js";import{a as P,S as Y,I as B}from"./helpers-OX9dLWze.js";import{n as y}from"./noop-BjFrJKj1.js";import{S as k}from"./SvgIcon-Couf_zSm.js";import{T as H}from"./Tag-COFJYHTe.js";import{D as C,C as z}from"./DialogBuilder-C9kpHNTI.js";import{a as G,u as W,E as $}from"./constants-DB0KHtoC.js";import"./store-DbzJj_LB.js";import"./SnackBar-CFKLicS3.js";import{T as Z}from"./TextInput-zKXuivzK.js";import"./chunk-EPOLDU6W-Ctqe8aNe.js";import"./preload-helper-PPVm8Dsz.js";import"./index-5eldUqfX.js";import"./Tooltip-B7ljFVlc.js";import"./stroke-pass-CALgybTM.js";import"./exports-CJO67oad.js";import"./full-thumb-up-Bb4kpRpM.js";import"./index-ne9dZ5bB.js";import"./index-D_hrvjzL.js";import"./index-CMKhSJwB.js";import"./tslib.es6-BUas5LQb.js";import"./stroke-close-DnlFsd1c.js";import"./date-CrU56jqV.js";import"./full-clear-Q4kCtSRL.js";import"./full-close-5Oxr7nnd.js";import"./full-validate-CbMNulkZ.js";import"./useMediaQuery-DtUngo6D.js";import"./FieldFooter-BzHKVGZY.js";import"./full-error-BFAmjN4t.js";import"./index.module-ubM7OgmK.js";import"./FieldHeader-DRvYsUWo.js";const J=o=>o.user.currentUser,T=s.createContext({setVideoUrl:y,videoData:void 0,handleVideoOnSubmit:async()=>{throw new Error("VideoUploaderContext not provided")},onVideoUpload:y,onVideoDelete:y,offerId:void 0}),N=()=>s.useContext(T);function R({children:o,initialVideoData:r,offerId:t}){const[i,a]=s.useState(r?.videoUrl),[l,n]=s.useState(r),_=async({onSuccess:d,onError:E})=>{if(i)try{const V=await j.getOfferVideoMetadata(i);n(V),d()}catch(V){const O=P(V);E(O)}},b=()=>{a(void 0),n(void 0)},u=s.useCallback(async()=>await j.patchOffer(t,{videoUrl:i??""}),[i,t]);return e.jsx(T.Provider,{value:{videoUrl:i,videoData:l,handleVideoOnSubmit:u,setVideoUrl:a,onVideoUpload:_,onVideoDelete:b,offerId:t},children:o})}try{R.displayName="VideoUploaderContextProvider",R.__docgenInfo={description:"",displayName:"VideoUploaderContextProvider",props:{offerId:{defaultValue:null,description:"",name:"offerId",required:!0,type:{name:"number"}},initialVideoData:{defaultValue:null,description:"",name:"initialVideoData",required:!1,type:{name:"VideoData"}}}}}catch{}const m={"video-preview":"_video-preview_ma276_1","video-duration":"_video-duration_ma276_15","video-image":"_video-image_ma276_21","video-title":"_video-title_ma276_27"};function K(o){return Math.round(o/60).toLocaleString("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:1})}const U=({videoDuration:o,videoTitle:r,videoThumbnailUrl:t})=>e.jsxs("div",{className:m["video-preview"],children:[e.jsx(Y,{alt:"Prévisualisation de l’image",className:m["video-image"],src:t,placeholder:e.jsx(B,{})}),e.jsx("span",{className:m["video-duration"],children:e.jsx(H,{label:`${K(o??0)} min`})}),e.jsx("p",{className:m["video-title"],children:r})]});try{U.displayName="VideoPreview",U.__docgenInfo={description:"",displayName:"VideoPreview",props:{videoDuration:{defaultValue:null,description:"",name:"videoDuration",required:!1,type:{name:"number | null"}},videoTitle:{defaultValue:null,description:"",name:"videoTitle",required:!1,type:{name:"string | null"}},videoThumbnailUrl:{defaultValue:null,description:"",name:"videoThumbnailUrl",required:!0,type:{name:"string"}}}}}catch{}const Q=new RegExp(/^(https?:\/\/)(www\.)?(m\.)?(youtube\.com\b|youtu\.be\b)(\/watch\?v=|\/embed\/|\/v\/|\/e\/|\/)([\w-]{11}\b)/),x=o=>{const r="Veuillez renseigner une URL valide. Ex : https://exemple.com",t="Veuillez renseigner une URL provenant de la plateforme Youtube. Les shorts et les chaînes ne sont pas acceptées.";if(!o||o.trim()==="")return t;try{const a=new URL(o).hostname.toLowerCase();return(a==="youtu.be"||a==="www.youtu.be"||a==="youtube.com"||a==="www.youtube.com"||a==="www.m.youtube.com"||a==="m.youtube.com")&&Q.test(o)?void 0:t}catch{return r}},X=""+new URL("youtube-logo-DoyiBwVG.png",import.meta.url).href,w={"modal-video":"_modal-video_1esiw_1","modal-video-content":"_modal-video-content_1esiw_7","modal-video-footer":"_modal-video-footer_1esiw_12"},h=({...o})=>{const[r,t]=s.useState(),{videoUrl:i,onVideoUpload:a,setVideoUrl:l,offerId:n}=N(),_=G(J),{logEvent:b}=W();return e.jsx(C,{...o,title:"Ajouter une vidéo",imageTitle:e.jsx("img",{alt:"",src:X}),variant:"drawer",children:e.jsxs("div",{className:w["modal-video"],children:[e.jsx("div",{className:w["modal-video-content"],children:e.jsx(Z,{name:"videoUrl",label:"Lien URL Youtube",description:"Format : https://www.youtube.com/watch?v=0R5PZxOgoz8",error:r,value:i??"",onBlur:u=>{const d=u.target.value;t(x(d)),d&&x(d)&&b($.OFFER_FORM_VIDEO_URL_ERROR,{offerId:n,userId:_?.id,videoUrl:d})},onChange:u=>{l(u.target.value)}})}),e.jsx(C.Footer,{children:e.jsxs("div",{className:w["modal-video-footer"],children:[e.jsx(z,{asChild:!0,children:e.jsx(c,{variant:g.SECONDARY,color:v.NEUTRAL,label:"Annuler"})}),e.jsx(c,{onClick:async()=>{i&&!x(i)&&await a({onSuccess:()=>{o.onOpenChange?.(!1)},onError:t})},label:"Ajouter"})]})})]})})};try{h.displayName="ModalVideo",h.__docgenInfo={description:"",displayName:"ModalVideo",props:{className:{defaultValue:null,description:"Custom CSS class for additional styling of the dialog content.",name:"className",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"The heading title of the dialog.",name:"title",required:!1,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!1,type:{name:"enum",value:[{value:'"default"'},{value:'"drawer"'}]}},open:{defaultValue:null,description:"Controls the open state of the dialog.",name:"open",required:!1,type:{name:"boolean"}},trigger:{defaultValue:null,description:"The trigger element that opens the dialog.",name:"trigger",required:!1,type:{name:"ReactNode"}},refToFocusOnClose:{defaultValue:null,description:`Ref of the element to focus on when the dialog is closed.
If refToFocusOnClose.current is null, the trigger element will be focused as a fallback.`,name:"refToFocusOnClose",required:!1,type:{name:"RefObject<HTMLElement>"}},isTitleHidden:{defaultValue:null,description:`Determines if the title is visually hidden.

When the title is visually hidden, it is still accessible to screen readers.`,name:"isTitleHidden",required:!1,type:{name:"boolean"}},imageTitle:{defaultValue:null,description:"An image for the title.",name:"imageTitle",required:!1,type:{name:"ReactNode"}},defaultOpen:{defaultValue:{value:"false"},description:"Determines if the dialog is open by default.",name:"defaultOpen",required:!1,type:{name:"boolean"}},onOpenChange:{defaultValue:null,description:"Callback function triggered when the open state of the dialog changes.",name:"onOpenChange",required:!1,type:{name:"((open: boolean) => void)"}},closeButtonClassName:{defaultValue:null,description:"Custom CSS class for additional styling of the close button.",name:"closeButtonClassName",required:!1,type:{name:"string"}}}}}catch{}const p={"video-uploader-container":"_video-uploader-container_6b2er_1","video-uploader-no-video":"_video-uploader-no-video_6b2er_5","action-wrapper":"_action-wrapper_6b2er_21","video-uploader-text-subtle":"_video-uploader-text-subtle_6b2er_30"},ee=()=>{const[o,r]=s.useState(!1),{videoData:t,onVideoDelete:i}=N(),{videoDuration:a,videoTitle:l,videoThumbnailUrl:n}=t??{};return e.jsx("div",{className:p["video-uploader-container"],children:n?e.jsxs(e.Fragment,{children:[e.jsx(U,{videoDuration:a,videoTitle:l,videoThumbnailUrl:n}),e.jsxs("div",{className:p["action-wrapper"],children:[e.jsx(h,{onOpenChange:r,open:o,trigger:e.jsx(c,{variant:g.SECONDARY,color:v.NEUTRAL,size:L.SMALL,icon:A,label:"Modifier"})}),e.jsx(c,{variant:g.TERTIARY,color:v.NEUTRAL,icon:q,onClick:i,label:"Supprimer"})]})]}):e.jsxs("div",{className:p["video-uploader-no-video"],children:[e.jsx(k,{src:F,alt:"",width:"44"}),e.jsx(h,{onOpenChange:r,open:o,trigger:e.jsx(c,{variant:g.TERTIARY,color:v.NEUTRAL,icon:M,label:"Ajouter une URL Youtube"})}),e.jsx("p",{className:p["video-uploader-text-subtle"],children:"Affichage de la prévisualisation ici"})]})})},Pe={title:"@/components/VideoUploader/VideoUploader",component:ee,decorators:[D,o=>e.jsx(S,{store:I({}),children:e.jsx(o,{})})]},f={args:{}};f.parameters={...f.parameters,docs:{...f.parameters?.docs,source:{originalSource:`{
  args: {}
}`,...f.parameters?.docs?.source}}};const Ye=["WithoutImage"];export{f as WithoutImage,Ye as __namedExportsOrder,Pe as default};
